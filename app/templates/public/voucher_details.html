{% extends 'shared/base.html' %}
{% block title %}ุชูุงุตูู ุงูุณูุฏ โ ุฌูููุฉ{% endblock %}

{% block content %}
<h3 class="my-4">ุชูุงุตูู ุงูุณูุฏ</h3>

<div class="card mb-4 shadow-sm">
  <div class="card-body">
    <h5 class="card-title text-primary">{{ voucher.product }}</h5>

    <ul class="list-group list-group-flush">
      <li class="list-group-item"><strong>ุงูููุฏ:</strong> {{ voucher.code }}</li>
      <li class="list-group-item"><strong>ุงููููุฉ:</strong> {{ voucher.quantity }}</li>
      <li class="list-group-item">
          <strong>ุงูุณุนุฑ ุงูุฅุฌูุงูู:</strong>
          {{ "%.2f"|format(voucher.total_price) }} ุฑ.ุณ
          (ุดุงูู {{ (voucher.vat_rate*100)|int }}%)
      </li>
      <li class="list-group-item">
          <strong>ุนูููุฉ ุงููุฑูุฌ:</strong> {{ "%.2f"|format(voucher.factory_commission) }} ุฑ.ุณ
      </li>
    </ul>

    {# ุฒุฑ ุชุญููู / ูุนุงููุฉ PDF ุฅุฐุง ูุงู ุงูุฑุงุจุท ููุฌูุฏุงู #}
    {% if voucher.invoice_path %}
      <a class="btn btn-outline-secondary mt-3"
         href="{{ voucher.invoice_path }}"
         target="_blank">
         ๐ ุชุญููู / ูุนุงููุฉ PDF
      </a>
    {% endif %}

    <hr>

    {# ุงูุชูุนูู ุงูุฃูู โ ููุณูุญ ููุท ูููุฑูุฌูู #}
    {% if current_user.is_authenticated %}
      {% if current_user.is_promoter %}
        <form method="POST" action="{{ url_for('public.activate_voucher', code=voucher.code) }}">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
          <button type="submit" class="btn btn-success">
            ุชูุนูู ูุฑุจุท ุงูุณูุฏ ุจุญุณุงุจู
          </button>
        </form>
      {% else %}
        <div class="alert alert-info mt-2">
          ุฃูุช ูุณุฌู ููุตูุน ุฃู ูุณุคููุ ูุง ููููู ุชูุนูู ุงูุณูุฏ ููุฑูุฌ.
        </div>
      {% endif %}
    {% else %}
      <div class="alert alert-warning mt-2">
        ูุฑุฌู <a href="{{ url_for('auth.login') }}">ุชุณุฌูู ุงูุฏุฎูู</a> ูุชูุนูู ุงูุณูุฏ.
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
