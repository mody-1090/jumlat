{% extends "dashboard_promoter/base.html" %}
{% block promoter_content %}

<h3 class="mb-4">ุณูุฏุงุชู</h3>

{# โโโโโ ุชุนูููุงุช ุซุงุจุชุฉ โโโโโ #}
<div class="card mb-4">
  <div class="card-body">
    <h5 class="card-title mb-3">ุฏููู ุงูุฑุจุญ ูู ุงูุณูุฏุงุช โ ููู ุชุนูู ููุตูุชูุงุ</h5>

    <p class="mb-2">
      ูุญู <strong>ููุตูุฉ ูุณูุทุฉ</strong> ุชุฑุจุทู ุจุงููุตูุน ูุจุงุดุฑุฉ. ูุณุชู ุจุญุงุฌุฉ ุฅูู ุฑุฃุณ ูุงู
      ุฃู ูุฎุฒูู ูุณุจูุ ุฏูุฑู ูู <strong>ุฌูุจ ุงูุนููู</strong> ููุทุ ุจูููุง ูููู ุงููุตูุน
      ุจุชุฌููุฒ ุงูุทูุจ ูุชูุตูู ุงูุจุถุงุนุฉ ุจูุธุงู
      <em>ุงูุฏูุน ุนูุฏ ุงูุงุณุชูุงู (Cash On Delivery)</em>. ุจุนุฏ ุฅุชูุงู ุงูุนูููุฉ
      ุชูุญุชุณุจ ุนูููุชู ุนู ูู ูุฑุชูู ููุจุงุน.
    </p>

    <p class="fw-bold mb-1">ูุฏูู ุทุฑููุชุงู ูุงุณุชุฎุฏุงู ุงูุณูุฏ:</p>
    <ul>
      <li>
        <strong>ุงูุทุฑููุฉ&nbsp;ุงูุฃููู โ ุฅูุดุงุก ุงูุทูุจ ููุงุจุฉ ุนู ุงูุนููู:</strong>
        ุงุฎุชุฑ ุงูุณูุฏ ุงููุทููุจ ุซู ุงุถุบุท
        <span class="badge bg-primary">ุฅูุดุงุก ุทูุจ</span>ุ ูุงุฏุฎูู ุงุณู ุงูุนููู
        ูุฑูู ุฌูุงูู. ูุตู ุงูุทูุจ ุฅูู ุงููุตูุน ููุฑูุง ูููุดุญู ุฅูู ุงูุนูููุ ูุณุชุฑู
        ุญุงูุชู ุชุชุญููู ุฅูู
        <span class="badge bg-success">ุชู ุงูุทูุจ</span>.
      </li>

      <li>
        <strong>ุงูุทุฑููุฉ&nbsp;ุงูุซุงููุฉ โ ุทุจุงุนุฉ ุงูุณูุฏ ูุฅุนุทุงุคู ููุนููู ุงููุญุชูู:</strong>
        ุงุญูุธ ููู ุงูู PDF ุงูุฐู ูุญุชูู ุฑูุฒ&nbsp;QRุ ูุงุทุจุนู ุฃู ุฃุฑุณูู ููุนููู.
        ุนูุฏ ูุณุญ ุงูู QR ูููุชุญ ูููุฐุฌ ุงูุทูุจ ููููุฃ ุงูุนููู ุจูุงูุงุชู ุจููุณู.
      </li>
    </ul>

    <p class="fw-bold mb-1">ูุซุงู ุนููู ุณุฑูุน:</p>
    <ol class="ps-3 mb-0">
      <li>ูุฏูู ุนููู ูุญูู ุนุตุงุฆุฑ ูุฑุบุจ ูู ุทูุจ <strong>10 ูุฑุงุชูู</strong>.</li>
      <li>ุงุฎุชุฑ ุณูุฏ ยซุนุตูุฑ ร 10ยป ูุงุถุบุท ยซุฅูุดุงุก ุทูุจยปุ ุซู ุฃุฏุฎูู ุงุณู ุตุงุญุจ ุงููุญู ูุฑูู ุฌูุงูู.</li>
      <li>ุจุนุฏ ุฃู ููุณูููู ุงูุทูุจ ูููุญุตูู ุซููู ุนูุฏ ุงูุงุณุชูุงูุ ุชูุชูู ุนูููุชู ุชููุงุฆููุง ูู
          ยซ<span class="text-muted">ูุญุชููุฉ</span>ยป ุฅูู
          ยซ<span class="text-primary">ูุคูููุฏุฉ</span>ยป ุซู ุฅูู
          ยซ<span class="text-success">ุชู ุงูุชุญููู</span>ยป ุนูุฏูุง ูุญููููุง ุงููุตูุน.</li>
    </ol>
  </div>
</div>

{# โโโโโ ุงูุชุตููุฉ ุจุงูููุชุฌ โโโโโ #}
<form method="get" class="mb-3 d-inline-block">
  <label class="fw-bold me-2">ุชุตููุฉ ุงูููุชุฌ:</label>
  <select name="product" class="form-select d-inline w-auto" onchange="this.form.submit()">
    <option value="all" {{ 'selected' if chosen == 'all' }}>ููู ุงูููุชุฌุงุช</option>
    {% for p in products %}
      <option value="{{ p }}" {{ 'selected' if p == chosen }}>{{ p }}</option>
    {% endfor %}
  </select>
</form>

{# โโโโโ ุงูุชุจููุจุงุช ุญุณุจ ุงูุญุงูุฉ โโโโโ #}
<ul class="nav nav-tabs mb-3">
  <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#tab-active">
      ๐ ููุนูููุฉ ({{ active|length }})</a></li>
  <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#tab-used">
      โ ุชู ุงูุทูุจ ({{ used|length }})</a></li>
</ul>

<div class="tab-content">

{% macro render_table(vouchers) -%}
  <table class="table table-hover align-middle">
    <thead class="table-light">
      <tr>
        <th style="width:120px">ุงูููุฏ</th>
        <th style="width:90px">ุงูุญุงูุฉ</th>
        <th>ุงูููุชุฌ</th>
        <th class="text-center" style="width:90px">ุงููููุฉ</th>
        <th class="text-center" style="width:160px">ุงูุฅุฌุฑุงุก</th>
      </tr>
    </thead>
    <tbody>
      {% for v in vouchers %}
      <tr>
        <td>{{ v.code }}</td>
        <td>
          {% if v.status == 'active' %}
            <span class="badge bg-warning text-dark">ููุนููู</span>
          {% else %}
            <span class="badge bg-success">ุชู ุงูุทูุจ</span>
          {% endif %}
        </td>
        <td>{{ v.product }}</td>
        <td class="text-center">{{ v.quantity }}</td>
        <td class="text-center">
          {% if v.status == 'active' %}
            <a class="btn btn-sm btn-primary"
               href="{{ url_for('public.confirm_order', code=v.code) }}">
              ุฅูุดุงุก ุทูุจ
            </a>
          {% endif %}
        </td>
      </tr>

      {# ูุนุงููุฉ ุงูู PDF #}
{# ุฒุฑ ุชุญููู ุงูู PDF #}
<tr class="table-secondary">
  <td colspan="5" class="text-center">
    {% if v.invoice_path %}
      {# ุงุฎุชุฑ ุงูุฑุงุจุท ุงูููุงุณุจ: ุณุญุงุจู ุฃู ุฏุงุฎู static #}
      {% if v.invoice_path.startswith('http') %}
        {% set pdf_url = v.invoice_path %}
      {% else %}
        {% set pdf_url = url_for('static', filename=v.invoice_path) %}
      {% endif %}

      <a href="{{ pdf_url }}" target="_blank" class="btn btn-outline-secondary">
        ๐ ุชุญููู ุงูุณูุฏ (PDF)
      </a>
    {% else %}
      <span class="text-danger">ูู ูุชู ุชูููุฏ ููู PDF ููุฐุง ุงูุณูุฏ ุจุนุฏ.</span>
    {% endif %}
  </td>
</tr>
      {% endfor %}
    </tbody>
  </table>
{%- endmacro %}

  <div class="tab-pane fade show active" id="tab-active">
    {{ render_table(active) }}
  </div>

  <div class="tab-pane fade" id="tab-used">
    {{ render_table(used) }}
  </div>

</div>
{% endblock %}
